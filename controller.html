<html>
<head>
<title>Rider Feud</title>
<style>
body {
    font-family: Arial;
}

.text {
    padding: 10px 0px;
}

.button {
    padding: 10px;
    background: #00ace4;
    color: white;
    cursor: pointer;
    border-radius: 5px;
    width: 150px;
    margin: 10px 0px;
}
.button:hover {
    opacity: 0.8;
}
.button:active {
    opacity: 0.6;
}
</style>
</head>
<body>
<div class="text" id="status_text">Current status: before_start</div>
<div class="button" onclick="continueRound()">Continue Round</div>
<div class="text" id="round_text">Current round index: 0</div>
<div class="text" id="question_text">Current question index: 0</div>
<div class="button" onclick="nextQuestion()">Next question</div>
<div class="button" onclick="correct(0)">LEFT team correct</div>
<div class="button" onclick="correct(1)">RIGHT team correct</div>
<div class="button" onclick="incorrect()">Incorrect</div>

<audio id="wrong">
  <source src="wrong.mp3" type="audio/mp3">
</audio>
<audio id="right">
  <source src="right.mp3" type="audio/mp3">
</audio>

<video id="music" style="visibility: hidden;">
    <source src="music.mp4" type="video/mp4">
</video>
<script>
var status = "before_start";
var round_index = 0;
var score = [];
var question_index = 0;
var round_teams = [["freshmen","sophomores"],["juniors","seniors"],[]];

function continueRound() {
if (status == "winner") {
    score[0] = 0;
    score[1] = 0;
    status = "before_round"
    round_index++;
    message_broadcast({'command':'update_status',"data":"before_round","teams":round_teams[round_index]});
    document.querySelector("#round_text").innerHTML = "Current round index: "+round_index;
    nextQuestion();
    return document.querySelector("#status_text").innerHTML = "Current status: "+status;
}
if (status == "in_round") {
    status = "winner"
    message_broadcast({'command':'update_status',"data":"winner","team":round_teams[round_index][(score[0] > score[1] ? 0 : 1)]});
    round_teams[2][round_index] = round_teams[round_index][(score[0] > score[1] ? 0 : 1)];
    document.querySelector("#music").currentTime = 126;
    document.querySelector("#music").play();
}
if (status == "before_round") {
    status = "in_round"
    message_broadcast({'command':'update_status',"data":"in_round"});
}
if (status == "before_start") {
    score[0] = 0;
    score[1] = 0;
    message_broadcast({'command':'update_status',"data":"before_round","teams":["freshmen","sophomores"]});
    status = "before_round";
}
document.querySelector("#status_text").innerHTML = "Current status: "+status;
}

function incorrect() {
    message_broadcast({'command':'wrong'});
    document.querySelector("#wrong").currentTime = 1.2;
    document.querySelector("#wrong").play();
}

function correct(id) {
    message_broadcast({'command':'right','data':id});
    document.querySelector("#right").play();
    score[id]++;
}

function nextQuestion() {
    question_index++;
    document.querySelector("#question_text").innerHTML = "Current question index: "+question_index;
    if (question_index > 8) {
        document.querySelector("#question_text").style.color = "red";
    } else {
        document.querySelector("#question_text").style.color = "green";
    }
    message_broadcast({'command':'next_question',"data":question_index});
}

function message_broadcast(message)
{
    localStorage.setItem('message',JSON.stringify(message));
    localStorage.removeItem('message');
}
</script>
</body>
</html>